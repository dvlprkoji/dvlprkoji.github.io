EKS란 AWS에서 Kubernetes를 관리형 서비스로 제공해주는 솔루션입니다

EKS의 특징으로는

먼저, 완전관리형 Kubenetes control plane 서비스를 제공합니다
플랫폼 운영 API를 중앙 처리한 API 서버
정보 저장을 위한 ectd,
스케줄러나 컨트톨러 매니저와 같은 주요 마스터 컴포넌트를 완전관리형으로 제공합니다

둘쨰, AWS의 다양한 서비스들과 밀접하게 통합이 됩니다
storage 걱정 없이 이미지를 저장할 수 있는 ecr 이라고 하는 이미지 레파지토리나
arb nlb 와 같이 Kubernetes 앞에서 외부 트래픽에 대한 로드 밸런싱 서비스,
그 밖에도 인증이나 보안, 네트워크 스토리지 서비스 등 다양한 부분에서 AWS의 서비스들과 통합됩니다

EKS는 Kubenetes를 AWS Cloud 내에서 Production 레벨로 쉽게 구성하고 운영할 수 있게 해주는
관리형 서비스입니다



구조적으로 보면

플랫폼 제어의 역할을 하는 컨트롤 플레인과 실제 컨테이너를 띄워주는 워커 노드로 구분할 수 있습니다

컨트롤 플레인은 앞서 말씀드린대로 운영 api를 중앙 처리하는 api 서버,
정보 저장을 하기 위한 etcd, 스케줄러나 컨트롤러 매니저와 같은 주요 master 컴포넌트를 포함하고 있습니다

사용자는 kubectl을 통해 컨트롤 플레인의 api endpoint에 접근을 해서, 클러스터 내에서 컨테이너를 배포하는 등의
오퍼레이션을 수행하게 됩니다

데이터 플레인은 우측에 보시는 것처럼 컨테이너 런타임을 통해 서비스하는 컨테이너를 플랫폼 내에 띄워주는 역할을 합니다

이를 위해 kublet과 kube-proxy라고 하는 네트워크 및 컨테이너 라이프사이클 관리를 하는 컴포넌트를 가지고 있습니다

컨트롤 플레인과 데이터 플레인의 조금 더 상세한 구조를 살펴보면, 다음과 같습니다

화면 우측의 컨트롤 플레인을 보시면, 아마존 vpc라고 되어 있는데, 사용자가 직접 접속할 수 없는 영역입니다
내부적으로는 네트워크 로드 밸런서를 통해 분산 구성된 다중 가용 영역에 부하 분산 처리가 되도록 되어 있습니다

데이터 플레인은 고객 영역의 vpc에 위치하면서, elastic network interface라고 하는 eni를 통해
컨트롤 플레인 요청을 받아들여 운영됩니다

오토스케일링 그룹으로 묶인 워커 노드 인스턴스 위에 컨테이너 런타임을 가지고 서비스하는 구성입니다





쿠버네티스를 오케스트레이션 플랫폼으로 사용하기 위한, 구성 방안은 3가지가 있습니다

첫 번째는 on-premise 위 베어 메탈, 혹은 가상 서버에 직접 설치해 운영하는 방법이 있습니다
클라우드의 가상 서버를 이용하는 방식
eks와 같은 관리형 서비스를 이용하는 방식이 있습니다

그렇다면 eks를 사용하는 이점은 무엇일까요

보시는 것처럼 다양하고 넓은 범위에서 장점을 가지고 있습니다

첫 번째는 설치의 용이성입니다
과거에는 쿠버네티스 설치가 어려웠습니다
on-premise의 다양한 환경을 만족시키는 설치 툴을 만드는 것은 매우 어려웠습니다
EKS는 eksctl과 같은 cli 툴을 통해 클러스터를 매우 쉽고 빠르게 설치할 수 있습니다

두 번째는 가용성 입니다
개별 인스턴스는 다운될 수 있지만, 서비스 자체는 장애 없이 유지해야 합니다
AWS는 AZ라는 가용 영역 개념을 가지고 있습니다
하나의 가용 영역은 단순히 하나의 물리적 데이터 센터가 아니고, 2개 이상의 데이터 센터를 고속으로 연결해서
하나의 가용 영역을 만드는 개념입니다
일반 개별 기업들이 가용 영역 정도의 가용성을 제공하기는 현실적으로 어렵습니다
EKS는 다중 가용 영역을 제공하기 때문에 서비스 안정성 측면에서 장점을 가집니다

세 번째는 용량 관리 및 탄력성과 관련된 내용입니다
EKS는 총 3가지 방법으로 용량 관리 방법을 제공합니다
기존처럼 수동으로 관리하는 방법이 있고,
혹은 오토 스케일링 기반의 노드 그룹을 생성하는 방식을 사용할 수 있습니다
또한 서버리스 컴퓨팅 방식인 Fargate를 사용하는 방법이 있습니다

우선, eksctl이라고 하는 툴을 통해 클러스터를 생성하고, 어플리케이션을 배포합니다
retail이라는 이름으로 2개의 노드를 가진 클러스터를 생성했습니다

보시는 것처럼 자동으로 서브넷 구성 및 할당이 된 것을 확인하실 수 있습니다


