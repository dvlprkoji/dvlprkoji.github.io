<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="예제로 살펴보는 객체지향의 원칙" /><meta property="og:locale" content="en" /><meta name="description" content="다음과 같은 User 클래스가 있다고 해보자 ```java public class User{ String id; String name; String password;" /><meta property="og:description" content="다음과 같은 User 클래스가 있다고 해보자 ```java public class User{ String id; String name; String password;" /><link rel="canonical" href="https://dvlprkoji.github.io/posts/aop/" /><meta property="og:url" content="https://dvlprkoji.github.io/posts/aop/" /><meta property="og:site_name" content="Koji’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-25T09:00:01+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="예제로 살펴보는 객체지향의 원칙" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-11-25T09:00:01+09:00","datePublished":"2021-11-25T09:00:01+09:00","description":"다음과 같은 User 클래스가 있다고 해보자 ```java public class User{ String id; String name; String password;","headline":"예제로 살펴보는 객체지향의 원칙","mainEntityOfPage":{"@type":"WebPage","@id":"https://dvlprkoji.github.io/posts/aop/"},"url":"https://dvlprkoji.github.io/posts/aop/"}</script><title>예제로 살펴보는 객체지향의 원칙 | Koji's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Koji's Blog"><meta name="application-name" content="Koji's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn-icons-png.flaticon.com/512/822/822123.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Koji's Blog</a></div><div class="site-subtitle font-italic">Backend Develeoper</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/dvlprkoji" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['koji4321','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>예제로 살펴보는 객체지향의 원칙</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>예제로 살펴보는 객체지향의 원칙</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> koji </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Nov 25, 2021, 9:00 AM +0900" >Nov 25, 2021<i class="unloaded">2021-11-25T09:00:01+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3164 words">17 min read</span></div></div><div class="post-content"><p>다음과 같은 User 클래스가 있다고 해보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span><span class="o">{</span>
    <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">setPassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 이 사용자 정보를 DB에 넣고 관리할 수 있는 DAO 클래스를 만들어보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost/springbook"</span><span class="o">,</span> <span class="s">"spring"</span><span class="o">,</span> <span class="s">"book"</span><span class="o">);</span>

        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost/springbook"</span><span class="o">,</span> <span class="s">"spring"</span><span class="o">,</span> <span class="s">"book"</span><span class="o">);</span>

        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="관심사-분리하기">관심사 분리하기</h2><p>개발자는 객체를 설계할 떄 미래의 변화를 고려해야 한다 요구사항의 변화가 생기면 코드를 수정해야 할 것이고 개발자는 매번 필요한 작업을 최소화해야 하며 변경이 다른 곳에 문제를 일으키지 않게 해야 할 것이다</p><p>이러한 설계는 바로 분리와 확장을 고려한 설계에서 나온다 먼저 관심사의 분리를 고려하도록 코드를 변경해보자</p><p>위의 UserDao에서 add() 메서드와 get() 메서드는 DB와의 Connection을 가져오는 동일한 코드가 존재한다 중복된 DB연결을 getConnection()이라는 이름의 독립적인 메서드로 추출해보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
      <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
      <span class="k">return</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost/springbook"</span><span class="o">,</span> <span class="s">"spring"</span><span class="o">,</span> <span class="s">"book"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 DB 연결과 관련된 부분에 변경이 일어났을 경우, getConnection() 메서드의 코드만 수정하면 된다</p><p>이제 또다른 상황을 가정해보자 getConnection()을 수정해 사용할 일이 많아지고, UserDao 클래스를 수정하지 않도록 해야 한다</p><h2 id="상속을-통한-확장">상속을 통한 확장</h2><p>getConnection() 메서드를 수정하도록 추상 메서드로 변경해서 이를 상속하도록 해 보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="c1">// 수정할 코드</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NUserDao</span> <span class="kd">extends</span> <span class="nc">UserDao</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
      <span class="c1">// N사가 사용할 Connection 구현</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DUserDao</span> <span class="kd">extends</span> <span class="nc">UserDao</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
    <span class="c1">// D사가 사용할 Connection 구현</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 UserDao 클래스를 수정하지 않고도 상속을 통해 손쉽게 확장이 가능해졌다 이렇게 슈퍼클래스에 기본적인 로직의 흐름을 만들고, 그 기능의 일부를 추상 메서드나 오버라이딩이 가능한 protected 메서드로 만들어 서브클래스에서 이러한 메서드를 필요에 맞게 구현해서 사용하도록 하는 방법을 <strong>템플릿 메소드 패턴</strong>이라고 한다 또한 서브클래스에 Connection 클래스의 생성 방법을 결정하기 때문에 <strong>팩토리 메소드 패턴</strong>이라고도 할 수 있다</p><p>이렇게 만들어진 UserDao 클래스에는 또 다른 몇 가지 문제가 존재한다 먼저, 상속을 통해 만들어진 클래스와 UserDao 클래스는 긴밀한 결합을 허용한다 서브클래스는 슈퍼클래스의 기능을 사용할 수 있고, 만약 슈퍼클래스의 수정이 일어나면 서브클래스에도 영향을 줄 것이다 또한, 상속, 구현한 getConnection() 메서드를 다른 클래스에서 사용할 수 없다는 것도 문제이다 만약 다른 클래스에서도 동일한 연결을 사용하고 싶다면 중복된 코드를 작성해야 할 것이다</p><h2 id="클래스의-분리">클래스의 분리</h2><p>이번엔 관심사가 다르고 변화의 성격이 다른 두 코드를 화끈하게 분리해보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SimpleConnectionMaker</span> <span class="n">simpleConnectionMaker</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserDao</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">simpleConnectionMaker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleConnectionMaker</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleConnectionMaker</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
      <span class="nc">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
      <span class="k">return</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost/springbook"</span><span class="o">,</span> <span class="s">"spring"</span><span class="o">,</span> <span class="s">"book"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 위에서 언급했던 문제들이 해결되었다 상속이 아닌 새로운 클래스를 사용했기 때문에 결합의 정도가 낮아졌고 한 번 작성한 Connection 생성 방법을 다른 클래스에서도 사용할 수 있다</p><p>하지만 또다른 큰 문제가 발생하였다 UserDao 클래스가 SimpleConnectionMaker 클래스에 종속되어 있기 때문에 다른 DB Connection을 제공하는 클래스를 제공하기 위해서는 UserDao를 수정해야 한다</p><p>또한 UserDao 클래스가 SimpleConnectionMaker 클래스의 정보를 너무 많이 알고 있다는 것도 문제이다 어떤 클래스가 쓰일지, 그 클래스에서 커넥션을 가져오는 메소드의 이름이 뭔지 알고 있어야 한다</p><h2 id="인터페이스의-도입">인터페이스의 도입</h2><p>두 클래스 간의 긴밀한 연결 관계가 느슨하도록 만들 수 있는 가장 좋은 방법은 추상화가 있다 추상화란 어떤 것들의 공통적인 성격을 뽑아내어 이를 따로 분리해내는 작업을 말한다 자바에서 추상화를 제공하는 가장 유용한 도구는 바로 인터페이스이다 바로 위에서 작성했던 코드에서 SimpleConnectionMaker 클래스를 인터페이스로 수정하면 다음과 같다</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SimpleConnectionMaker</span> <span class="n">simpleConnectionMaker</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserDao</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">simpleConnectionMaker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NConnectionMaker</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SimpleConnectionMaker</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NConnectionMaker</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
    <span class="c1">// N사 구현 Connection 생성 코드</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DConnectionMaker</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
    <span class="c1">// D사 구현 Connection 생성 코드</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 모든 문제를 해결한 듯 보인다 하지만 아직 하나의 문제가 남아있다 생성자에서 어떤 SimpleConnectionMaker 구현체를 사용할 것인지 지정해 주어야 한다는 것이다 이는 UserDao 클래스에서 SimpleConnectionMaker 클래스를 생성하는 책임을 가지고 있기 때문에 발생한 것이다 따라서 이 책임을 외부로 던져버린다면 다음과 같이 문제를 해결할 수 있을 것이다</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">UserDao</span><span class="o">{</span>
    <span class="kd">private</span> <span class="nc">SimpleConnectionMaker</span> <span class="n">simpleConnectionMaker</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserDao</span><span class="o">(</span><span class="nc">SimpleConnectionMaker</span> <span class="n">simpleConnectionMaker</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">simpleConnectionMaker</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span> <span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"insert into users(id, name, password)  values(?,?,?)"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

        <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">get</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
        <span class="nc">Connection</span> <span class="n">c</span> <span class="o">=</span> <span class="n">simpleConnectionMaker</span><span class="o">.</span><span class="na">makeNewConnection</span><span class="o">();</span>
        <span class="nc">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="s">"select * from users where id = ?"</span><span class="o">);</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>

        <span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">();</span>
        <span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">USer</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"id"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"password"</span><span class="o">));</span>

        <span class="n">rs</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">ps</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">c</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SimpleConnectionMaker</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NConnectionMaker</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
    <span class="c1">// N사 구현 Connection 생성 코드</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DConnectionMaker</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">makeNewConnection</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">ClassNotFoundException</span><span class="o">,</span> <span class="nc">SQLException</span><span class="o">{</span>
    <span class="c1">// D사 구현 Connection 생성 코드</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>이제 생성한 UserDao를 사용하는 클라이언트가 있다고 생각해보자 이를 UserDaoTest 클래스라고 하면, 이 클래스에는 Connection의 종류를 결정하여 UserDao 객체를 생성하는 책임이 있다 이러한 책임 또한 분리시켜 생각할 필요가 있으므로 DaoFactory 클래스를 만들어 보자</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DaoFactory</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nc">UserDao</span> <span class="nf">userDao</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ConnectionMaker</span> <span class="n">connectionMaker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DConnectionMaker</span><span class="o">();</span>
        <span class="nc">UserDao</span> <span class="n">userDao</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserDao</span><span class="o">(</span><span class="n">connectionMaker</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">userDao</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><p>만약 UserDao가 아닌 AccountDao, MessageDao 등의 클래스가 추가될 경우, 매번 DConnectionMaker 생성 코드를 작성해야 한다 따라서 중복을 제거한다면 다음과 같은 코드가 작성된다</p><div class="language-java highlighter-rouge"><div class="code-header" text-data="java"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DaoFactory</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nc">UserDao</span> <span class="nf">userDao</span><span class="o">()</span> <span class="o">{</span>
      <span class="nc">UserDao</span> <span class="n">userDao</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserDao</span><span class="o">(</span><span class="n">connectionMaker</span><span class="o">());</span>
      <span class="k">return</span> <span class="n">userDao</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">UserDao</span> <span class="nf">accountDao</span><span class="o">()</span> <span class="o">{</span>
      <span class="nc">AccountDao</span> <span class="n">accountDao</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AccountDao</span><span class="o">(</span><span class="n">connectionMaker</span><span class="o">());</span>
      <span class="k">return</span> <span class="n">userDao</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">MessageDao</span> <span class="nf">messageDao</span><span class="o">()</span> <span class="o">{</span>
      <span class="nc">MessageDao</span> <span class="n">messageDao</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageDao</span><span class="o">(</span><span class="n">connectionMaker</span><span class="o">());</span>
      <span class="k">return</span> <span class="n">userDao</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">ConnectionMaker</span> <span class="nf">connectionMaker</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="nf">DConnectionMaker</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h2 id="원칙과-패턴">원칙과 패턴</h2><h3 id="개방-폐쇄-원칙-open-closed-principle">개방 폐쇄 원칙 (Open-Closed Principle)</h3><blockquote><p>클래스나 모듈은 확장에는 열려 있고 변경에는 닫혀 있어야 한다</p></blockquote><p>작성한 UserDao의 경우 DB 연결 방법이라는 기능은 얼마든지 추가가 가능하므로 확장에는 열려 있고 자신은 변화에 영향을 받지 않는다는 점에서 변경에는 닫혀 있다고 할 수 있다</p><h3 id="높은-응집도와-낝은-결합도">높은 응집도와 낝은 결합도</h3><p>개방 폐쇄 원칙은 <strong>높은 응집도와 낮은 결합도</strong>로도 설명 가능하다</p><h3 id="높은-응집도">높은 응집도</h3><p>응집도가 높다는 것은 하나의 모듈, 클래스가 하나의 책임, 또는 관심사에만 집중되어 있다는 뜻이다 만약 최초의 UserDao처럼 여러 관심사와 책임이 얽혀 있는 복잡한 코드에서는 변경이 필요한 부분을 찾는 것도 번거롭고 변경으로 인해 변경되지 않는 부분에는 다른 영향을 주지 않는지 확인해야 하는 이중의 부담이 생긴다</p><h3 id="낮은-결합도">낮은 결합도</h3><p>결합도란 하나의 오브젝트가 변경될 때 관계를 맺고 있는 다른 오브젝트에게 변화를 요구하는 정도를 말한다 UserDao에 인터페이스를 도입한 후 DB 연결 기능을 구현한 클래스가 바뀌더라도 DAO의 코드는 변경될 필요가 없게 된다</p><h3 id="전략-패턴">전략 패턴</h3><blockquote><p>자신의 context 에서 변경이 필요한 부분을 인터페이스를 통해 외부로 분리시키는 디자인 패턴</p></blockquote><p>UserDao는 전략 패턴의 컨텍스트에 해당한다 컨텍스트는 자신의 기능 중 변경이 필요한 DB 연결 부분을 SimpleConnectionMaker 인터페이스를 통해 외부로 분리시켰다</p><h3 id="제어관계-역전-inversion-of-control-ioc">제어관계 역전 (Inversion of Control, IoC)</h3><blockquote><p>제어의 역전이란 제어의 권한을 자신이 아닌 다른 대상에게 위임하는 것</p></blockquote><p>예를 들어 최초의 UserDao 클래스는 자신이 직접 어떤 Connection을 만들 것인지 선택하고 생성했다 하지만 getConnection() 메서드를 추출함으로써 Connection을 선택하고 생성하는 제어권을 위임하였다</p><p>이제 정말 깔끔한 코드로 리팩토링을 완료하였다 다음은 스프링을 사용하여 좀더 일반적인 IoC를 구현해볼 것이다</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/spring/'>Spring</a>, <a href='/categories/core/'>Core</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/aop/" class="post-tag no-text-decoration" >aop</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=예제로 살펴보는 객체지향의 원칙 - Koji's Blog&url=https://dvlprkoji.github.io/posts/aop/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=예제로 살펴보는 객체지향의 원칙 - Koji's Blog&u=https://dvlprkoji.github.io/posts/aop/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=예제로 살펴보는 객체지향의 원칙 - Koji's Blog&url=https://dvlprkoji.github.io/posts/aop/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/spring-batch/">스프링 배치(Spring Batch) - 1. 스프링 배치 시작</a><li><a href="/posts/java-threadlocal/">자바 쓰레드 로컬(ThreadLocal)</a><li><a href="/posts/develop-oop/">객체 지향 설계 (OOP, Object Oriented Programming)</a><li><a href="/posts/spring-test/">스프링 테스트(test)</a><li><a href="/posts/dictionary/">객체 지향 설계의 5가지 원칙(OOP, Object Oriented Programming)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/batch/">batch</a> <a class="post-tag" href="/tags/comparable/">comparable</a> <a class="post-tag" href="/tags/comparator/">comparator</a> <a class="post-tag" href="/tags/servlet-container/">servlet container</a> <a class="post-tag" href="/tags/spring-container/">spring container</a> <a class="post-tag" href="/tags/spring-security/">spring security</a> <a class="post-tag" href="/tags/abstract-class/">abstract class</a> <a class="post-tag" href="/tags/abstract-method/">abstract method</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spring-template/"><div class="card-body"> <span class="timeago small" >Dec 1, 2021<i class="unloaded">2021-12-01T09:00:01+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>예제로 알아보는 스프링 템플릿(Template), 콜백(Callback)</h3><div class="text-muted small"><p> 이전에 작성했던 DB 커넥션 코드들 중 UserDao의 가장 단순한 메서드인 deleteAll()를 살펴보자 1 2 3 4 5 6 7 8 9 10 11 public class UserDao{ public void deleteAll() throws SQLException{ Connection c = dataSource.getConnect...</p></div></div></a></div><div class="card"> <a href="/posts/spring-service-abstraction/"><div class="card-body"> <span class="timeago small" >Dec 2, 2021<i class="unloaded">2021-12-02T09:00:01+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>스프링 서비스 추상화(Service Abstraction)</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/posts/web-servlet/"><div class="card-body"> <span class="timeago small" >Sep 27, 2021<i class="unloaded">2021-09-27T09:00:01+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>서블릿 컨테이너와 스프링 컨테이너</h3><div class="text-muted small"><p> 서블릿 컨테이너란? 서블릿은 개발자로 하여금 핵심 비즈니스 로직만 처리할 수 있도록 다양한 기능들을 수행한다 이러한 서블릿을 관리하는 서블릿들의 생성, 실행, 파괴, 즉 서블릿의 생명주기를 관리한다 스프링 컨테이너란? 스프링 컨테이너는 스프링 빈의 생명주기를 관리한다 스프링 빈의 생명주기는 다음과 같다 스프링 컨테이너 생성 -&gt; 스프링 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/redis-attribute/" class="btn btn-outline-primary" prompt="Older"><p>NoSQL과 Redis</p></a> <a href="/posts/spring-singleton/" class="btn btn-outline-primary" prompt="Newer"><p>스프링 싱글톤(Singleton)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/dvlprkoji">koji</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/batch/">batch</a> <a class="post-tag" href="/tags/comparable/">comparable</a> <a class="post-tag" href="/tags/comparator/">comparator</a> <a class="post-tag" href="/tags/servlet-container/">servlet container</a> <a class="post-tag" href="/tags/spring-container/">spring container</a> <a class="post-tag" href="/tags/spring-security/">spring security</a> <a class="post-tag" href="/tags/abstract-class/">abstract class</a> <a class="post-tag" href="/tags/abstract-method/">abstract method</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://dvlprkoji.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
